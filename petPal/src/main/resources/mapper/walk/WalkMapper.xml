<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	<mapper namespace="walk.dao.WalkDAO">
	
		<insert id="insertWalk" parameterType="walkVO">
			INSERT INTO HR.TBL_WALK
			(NUM, 
			USER_ID, 
			TITLE,  
			LOCATION, 
			"DATE", 
			WALK_TIME, 
			WALK_HOUR, 
			WALK_MINUTE, 
			CONTENT,
			REG_DATE,
			THUMB,
			AGE,
			BREED)
			VALUES(
			SEQ_WALK.NEXTVAL, 
			#{user_id}, 
			#{title}, 
			#{location}, 
			#{date}, 
			#{walk_time}, 
			#{walk_hour}, 
			#{walk_minute}, 
			#{content},
			SYSDATE,
			#{thumb},
			#{age},
			#{breed})
			
		</insert>
		
		<select id="selectWalkList" resultType="walkVO">
		<![CDATA[
			SELECT
			NUM, 
			USER_ID, 
			TITLE, 
			LOCATION, 
			"DATE", 
			WALK_TIME, 
			WALK_HOUR, 
			WALK_MINUTE, 
			CONTENT,
			REG_DATE,
			THUMB,
			AGE,
			BREED
			FROM (SELECT * FROM TBL_WALK WHERE NUM > 0 ORDER BY NUM DESC, REG_DATE DESC) WHERE ROWNUM BETWEEN 1 AND 20
		]]>
		</select>
		
		<select id="scrollDown" parameterType="_int" resultType="walkVO">
		<![CDATA[
			SELECT
			NUM, 
			USER_ID, 
			TITLE, 
			LOCATION, 
			"DATE", 
			WALK_TIME, 
			WALK_HOUR, 
			WALK_MINUTE, 
			CONTENT,
			REG_DATE,
			THUMB,
			AGE,
			BREED
			FROM TBL_WALK WHERE NUM <= #{num} AND NUM > #{num}-20 ORDER BY NUM DESC, REG_DATE DESC
		]]>
		</select>
		
		<select id="getWalk" parameterType="_int" resultType="walkVO">
			SELECT
			NUM, 
			USER_ID, 
			TITLE, 
			LOCATION, 
			"DATE", 
			WALK_TIME, 
			WALK_HOUR, 
			WALK_MINUTE, 
			CONTENT,
			REG_DATE,
			THUMB,
			AGE,
			BREED
			FROM TBL_WALK WHERE NUM = #{num}
		</select>
		
		<insert id="insertLike" parameterType="walkLikeVO">
			INSERT INTO TBL_WALK_LIKE (
			NUM,
			BOARD_NUM,
			USER_ID,
			LIKECHECK
			) VALUES(
			SEQ_WALKLIKE.NEXTVAL,
			#{board_num},
			#{user_id},
			1
			)
		</insert>
		
		<select id="searchWalkLike" parameterType="walkLikeVO" resultType="_int">
			SELECT COUNT(*) FROM TBL_WALK_LIKE WHERE BOARD_NUM = #{board_num} AND USER_ID = #{user_id}
		</select>
		
		<select id="getWalkLike" parameterType="map" resultType="_int">
			SELECT LIKECHECK FROM TBL_WALK_LIKE WHERE BOARD_NUM = #{board_num} AND USER_ID = #{user_id}
		</select>
		
		<update id="updateLike" parameterType="walkLikeVO">
			UPDATE TBL_WALK_LIKE
			SET LIKECHECK = #{likecheck}
			WHERE BOARD_NUM = #{board_num} AND USER_ID = #{user_id}
		</update>
	
	</mapper>
